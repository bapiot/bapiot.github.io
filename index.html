<!DOCTYPE html>
<html lang="tr" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Yapay ZekÃ¢ Destekli Ä°HA Projesi - Kontrol Paneli</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Slate & Sky -->
    <!-- Application Structure Plan: A single-page dashboard with header navigation to jump between sections: Project Summary, an interactive Gantt-style Timeline, a Role-based Task Distribution view, and a Technical Details accordion. This structure was chosen to allow both high-level project tracking (timeline) and role-specific views (task cards), facilitating easy navigation and reducing information overload for team members. Clicking on elements cross-references information between sections. -->
    <!-- Visualization & Content Choices: Timeline -> Goal: Show Change/Relationships -> Viz: HTML/CSS Gantt Chart -> Interaction: Click task to see details, filter by role -> Justification: Most intuitive way to visualize a project plan. Task Details -> Goal: Inform/Track Status -> Viz: Accordion List with integrated Firestore fields and detailed sub-tasks -> Interaction: Click to expand/collapse, Sub-checkboxes/Notes for persistence -> Justification: Detailed tracking via sub-tasks enhances accountability and progress visibility. Libraries: Vanilla JS, Tailwind CSS, Firebase Firestore. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f1f5f9;
        }
        .gantt-chart-container {
            display: grid;
            grid-template-columns: 150px 1fr;
            gap: 8px;
        }
        .gantt-grid {
            display: grid;
            grid-template-columns: repeat(52, minmax(0, 1fr)); /* 52 HaftalÄ±k Plan */
            gap: 1px;
            padding: 8px 0;
        }
        .gantt-bar {
            grid-column: auto; /* Grid column property now set directly in JS for reliability */
            transition: all 0.3s ease;
            cursor: pointer;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.06);
            font-size: 0.6rem; /* HaftalÄ±k sÃ¼tunlar daralÄ±nca yazÄ± kÃ¼Ã§Ã¼ltÃ¼ldÃ¼ */
        }
        .gantt-bar:hover {
            transform: scale(1.02);
            opacity: 1 !important;
        }
        .gantt-bar-dimmed {
             opacity: 0.3;
             filter: grayscale(80%);
        }
        .gantt-label {
            height: 40px; 
            display: flex;
            align-items: center;
            padding-left: 8px;
        }
        .header-underline {
            position: relative;
            padding-bottom: 8px;
        }
        .header-underline::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 50px;
            height: 3px;
            background-color: #0284c7;
        }
        .task-card.highlight {
            transform: scale(1.03);
            box-shadow: 0 0 25px rgba(2, 132, 199, 0.4);
            border-color: #0284c7;
        }
        .accordion-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease-out;
        }
        .bg-bm { background-color: #0ea5e9; } /* sky-500 */
        .border-bm { border-left-color: #0ea5e9; }
        .bg-eem { background-color: #10b981; } /* emerald-500 */
        .border-eem { border-left-color: #10b981; }
        .filter-active {
            background-color: #0284c7 !important;
            color: white !important;
        }
        .completed-task .accordion-header {
            background-color: #f0fdf4; /* green-50 */
        }
        .sub-task-label {
            transition: color 0.3s;
        }
        .sub-task-checkbox:checked + .sub-task-label {
            color: #16a34a; /* green-700 */
            text-decoration: line-through;
        }
        /* YENÄ° CSS: DÃ¶nme efektini yalnÄ±zca simgeye uygulayacak container */
        .accordion-icon {
            transition: transform 0.3s ease;
        }
        .accordion-icon.rotate-45 {
            transform: rotate(45deg);
        }
    </style>
    <!-- Firebase SDK Imports -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, doc, setDoc, onSnapshot, collection, setLogLevel } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // Firebase Global Variables (will be attached to window for global access)
        window.firebaseApp = null;
        window.db = null;
        window.auth = null;
        window.userId = null;
        window.appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
        const firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : {};
        const initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;

        setLogLevel('Debug'); 

        async function initializeFirebaseAndAuth() {
            try {
                if (Object.keys(firebaseConfig).length === 0) {
                    console.error("Firebase config is missing. Data persistence disabled.");
                    document.getElementById('user-id-display').textContent = "Veri KayÄ±t KapalÄ± (Config Yok)";
                    return;
                }

                window.firebaseApp = initializeApp(firebaseConfig);
                window.db = getFirestore(window.firebaseApp);
                window.auth = getAuth(window.firebaseApp);
                
                await new Promise(resolve => {
                    onAuthStateChanged(window.auth, async (user) => {
                        if (user) {
                            window.userId = user.uid;
                            document.getElementById('user-id-display').textContent = `KullanÄ±cÄ±: ${user.uid}`;
                            resolve();
                        } else {
                            try {
                                if (initialAuthToken) {
                                    await signInWithCustomToken(window.auth, initialAuthToken);
                                } else {
                                    await signInAnonymously(window.auth);
                                }
                            } catch (error) {
                                console.error("Authentication failed:", error);
                                window.userId = 'unauthenticated-user';
                                document.getElementById('user-id-display').textContent = `KullanÄ±cÄ±: Hata (${window.userId})`;
                            }
                            // Fallback in case onAuthStateChanged is slow or fails
                            if (window.auth.currentUser) {
                                window.userId = window.auth.currentUser.uid;
                                document.getElementById('user-id-display').textContent = `KullanÄ±cÄ±: ${window.userId}`;
                            } else {
                                window.userId = 'fallback-anonymous';
                                document.getElementById('user-id-display').textContent = `KullanÄ±cÄ±: Anonim (${window.userId})`;
                            }
                            resolve();
                        }
                    });
                });
                
                // Firestore listeners setup starts after successful auth
                if (window.userId && window.db) {
                     setupFirestoreListeners();
                }

            } catch (e) {
                console.error("Firebase initialization failed:", e);
                document.getElementById('user-id-display').textContent = "VeritabanÄ± BaÅŸlatÄ±lamadÄ±";
            }
        }
        
        // Yeni UI gÃ¼ncelleme fonksiyonu
        window.updateTaskCardUI = (taskId, subTaskStatus) => {
             const taskCard = document.getElementById(`task-card-${taskId}`);
             const mainCheckbox = document.getElementById(`completed-A${taskId}`);
             // window.projectData kullanÄ±ldÄ±
             const currentTaskDetails = window.projectData.details.find(d => d.id === taskId);
             
             if (!taskCard || !currentTaskDetails) return;

             let allSubTasksCompleted = true;
             
             currentTaskDetails.subTasks.forEach(subTask => {
                 // Sadece UI'daki alt kutucuklarÄ±n durumunu kontrol et
                 if (subTaskStatus[subTask.key] !== true) {
                     allSubTasksCompleted = false;
                 }
             });

             if (mainCheckbox) {
                 mainCheckbox.checked = allSubTasksCompleted; 
                 // Ana gÃ¶rev tamamlandÄ±ÄŸÄ±nda Gantt Ã§ubuÄŸunu da gÃ¶rsel olarak gÃ¼ncelleyebiliriz (opsiyonel)
             }
             
             if (allSubTasksCompleted) {
                 taskCard.classList.add('completed-task');
             } else {
                 taskCard.classList.remove('completed-task');
             }
             
             console.log(`Task ${taskId} overall status updated: ${allSubTasksCompleted}`);
        }

        async function setupFirestoreListeners() {
            // DEÄÄ°ÅÄ°KLÄ°K: Veriyi ortak (public) bir yoldan oku
            const collectionRef = collection(window.db, `artifacts/${window.appId}/public/data/project_tracking`);
            
            onSnapshot(collectionRef, (snapshot) => {
                snapshot.docChanges().forEach(change => {
                    const data = change.doc.data();
                    const taskId = change.doc.id;

                    const notesArea = document.getElementById(`notes-A${taskId}`);
                    const subTaskStatus = data.subTaskStatus || {};
                    // window.projectData kullanÄ±ldÄ±
                    const currentTaskDetails = window.projectData.details.find(d => d.id === taskId);
                    
                    if (currentTaskDetails && currentTaskDetails.subTasks) {
                        currentTaskDetails.subTasks.forEach(subTask => {
                            const subCheckbox = document.getElementById(`sub-A${subTask.key}`);
                            if (subCheckbox) {
                                // Firestore'dan gelen veriyi UI'a uygula
                                subCheckbox.checked = subTaskStatus[subTask.key] || false;
                            }
                        });
                    }

                    if (notesArea) {
                         notesArea.value = data.notes || '';
                    }

                    // Alt gÃ¶rev durumlarÄ±na gÃ¶re ana kartÄ± gÃ¼ncelle
                    window.updateTaskCardUI(taskId, subTaskStatus);
                });
                console.log("Task status updated from Firestore.");
            }, (error) => {
                console.error("Error listening to Firestore:", error);
            });
        }
        
        // Alt gÃ¶rev checkbox'larÄ±nÄ±n deÄŸiÅŸtiÄŸinde Firestore'a yazma ve UI'Ä± gÃ¼ncelleme
        window.saveTaskStatus = async (taskId, field, value) => {
            if (!window.db || !window.userId) {
                console.warn("Database or User ID is not ready.");
                return;
            }
            try {
                // DEÄÄ°ÅÄ°KLÄ°K: Veriyi ortak (public) bir yola kaydet
                const docRef = doc(window.db, `artifacts/${window.appId}/public/data/project_tracking`, taskId);
                
                let updateData = {};
                if (field === 'notes') {
                    updateData = { notes: value };
                } else if (field.startsWith('sub-')) {
                    // Update nested subTaskStatus map
                    const subTaskKey = field.substring(4); 
                    updateData = { subTaskStatus: { [subTaskKey]: value } };
                }
                
                await setDoc(docRef, updateData, { merge: true });
                console.log(`Task ${taskId} - ${field} saved.`);
                
                // Firestore dinleyicisi otomatik olarak gÃ¼ncel veriyi Ã§ekecek ve UI'Ä± gÃ¼ncelleyecektir (updateTaskCardUI Ã§aÄŸrÄ±sÄ± dinleyici iÃ§inde yapÄ±ldÄ±).
            } catch (e) {
                console.error("Error saving task status:", e);
            }
        }
        
        window.initializeFirebaseAndAuth = initializeFirebaseAndAuth;

    </script>
</head>
<body class="text-slate-800">

    <header class="bg-white/80 backdrop-blur-lg sticky top-0 z-50 shadow-md">
        <div class="container mx-auto px-6 py-4 flex justify-between items-center">
            <h1 class="text-xl md:text-2xl font-bold text-slate-900">
                ğŸš€ <span class="hidden sm:inline">Ä°HA Projesi Kontrol Paneli</span>
            </h1>
            <nav class="hidden md:flex space-x-6 text-base font-medium">
                <a href="#proje-akisi" class="text-slate-600 hover:text-sky-600 transition">Proje AkÄ±ÅŸÄ±</a>
                <a href="#gorev-dagilimi" class="text-slate-600 hover:text-sky-600 transition">GÃ¶rev DaÄŸÄ±lÄ±mÄ±</a>
                <a href="#teknik-detaylar" class="text-slate-600 hover:text-sky-600 transition">Teknik Detaylar</a>
            </nav>
            <div class="flex items-center gap-4">
                 <span id="user-id-display" class="text-xs text-slate-500 bg-slate-100 p-2 rounded-lg font-mono">Veri KaydÄ± BaÅŸlatÄ±lÄ±yor...</span>
                 <div id="mobile-menu-button" class="md:hidden text-2xl cursor-pointer">â˜°</div>
            </div>
        </div>
        <div id="mobile-menu" class="hidden md:hidden bg-white px-6 pb-4">
             <a href="#proje-akisi" class="block py-2 text-slate-600 hover:text-sky-600 transition">Proje AkÄ±ÅŸÄ±</a>
             <a href="#gorev-dagilimi" class="block py-2 text-slate-600 hover:text-sky-600 transition">GÃ¶rev DaÄŸÄ±lÄ±mÄ±</a>
             <a href="#teknik-detaylar" class="block py-2 text-slate-600 hover:text-sky-600 transition">Teknik Detaylar</a>
        </div>
    </header>

    <main class="container mx-auto p-4 md:p-8">

        <section id="proje-akisi" class="mb-12">
            <h2 class="text-3xl font-bold mb-6 header-underline">Proje AkÄ±ÅŸÄ± ve Zaman Ã‡izelgesi</h2>
            <p class="mb-8 text-slate-600 max-w-3xl">Proje, 4 ana faza yayÄ±lmÄ±ÅŸtÄ±r ve toplam 52 hafta (1 yÄ±l) sÃ¼rmesi hedeflenmektedir. AÅŸaÄŸÄ±daki interaktif zaman Ã§izelgesi, gÃ¶revlerin haftalÄ±k daÄŸÄ±lÄ±mÄ±nÄ±, sÃ¼relerini ve birbirleriyle olan iliÅŸkilerini gÃ¶stermektedir. Bir gÃ¶revin detaylarÄ±nÄ± gÃ¶rmek iÃ§in Ã¼zerine tÄ±klayabilirsiniz.</p>
            
            <div class="bg-white p-6 rounded-2xl shadow-lg overflow-x-auto">
                <div class="min-w-[1200px]"> <!-- 52 haftaya uyum saÄŸlamasÄ± iÃ§in minimum geniÅŸlik artÄ±rÄ±ldÄ± -->
                    <div class="gantt-chart-container mb-2">
                        <div></div>
                        <div class="gantt-grid text-xs text-center text-slate-500">
                            <!-- Gantt Headers will be generated by JS -->
                        </div>
                    </div>
                    <div id="gantt-chart" class="gantt-chart-container">
                        <!-- Gantt Rows will be generated by JS -->
                    </div>
                </div>
                 <div class="mt-4 flex flex-wrap gap-4 text-sm">
                    <div class="flex items-center gap-2"><div class="w-4 h-4 rounded-full bg-bm"></div><span>Bilgisayar MÃ¼h. (BM)</span></div>
                    <div class="flex items-center gap-2"><div class="w-4 h-4 rounded-full bg-eem"></div><span>Elektrik-Elektronik MÃ¼h. (EEM)</span></div>
                </div>
            </div>
        </section>

        <section id="gorev-dagilimi" class="mb-12">
            <h2 class="text-3xl font-bold mb-6 header-underline">Disipline GÃ¶re GÃ¶rev DaÄŸÄ±lÄ±mÄ±</h2>
             <p class="mb-8 text-slate-600 max-w-3xl">Her ekip Ã¼yesinin projedeki ana odak alanlarÄ± ve sorumluluklarÄ± aÅŸaÄŸÄ±da Ã¶zetlenmiÅŸtir. Bir roldeki gÃ¶revleri zaman Ã§izelgesinde vurgulamak iÃ§in ilgili butona tÄ±klayÄ±n.</p>
            <div class="grid md:grid-cols-2 gap-8">
                <!-- Role cards will be generated by JS -->
            </div>
        </section>

        <section id="teknik-detaylar">
            <h2 class="text-3xl font-bold mb-6 header-underline">Teknik Detaylar ve Ä°ÅŸ Paketleri (Firestore Destekli Takip)</h2>
            <p class="mb-8 text-slate-600 max-w-3xl">Her bir iÅŸ paketinin (Ä°P) detaylarÄ±, Ã§Ä±ktÄ±larÄ± ve baÅŸarÄ± kriterleri. AÅŸaÄŸÄ±daki kutucuklarÄ± iÅŸaretleyerek ve not ekleyerek gÃ¶rev durumunu **kalÄ±cÄ± olarak kaydedebilirsiniz** (Firebase Firestore).</p>
            <div id="accordion-container" class="space-y-4">
                <!-- Accordion items will be generated by JS -->
            </div>
        </section>

    </main>
    
    <footer class="text-center py-8 text-slate-500 text-sm">
        <p>Yapay ZekÃ¢ Destekli Ä°HA Projesi Kontrol Paneli | Abdullah GÃ¼l Ãœniversitesi</p>
    </footer>

<script>
    // projectData'nÄ±n global eriÅŸilebilir olmasÄ± iÃ§in window objesine taÅŸÄ±ndÄ±.
    window.projectData = {
        // Toplam sÃ¼re 52 haftaya yayÄ±ldÄ±. GÃ¶rev sÃ¼releri oransal olarak artÄ±rÄ±ldÄ± ve daha detaylÄ± planlandÄ±.
        tasks: [
            // FAZ 1: HAZIRLIK VE TEMEL KURULUM (Hafta 1-8)
            { id: 'A', name: 'Mekanik Montaj ve Kablolama', sorumlu: 'EEM 1', start: 1, duration: 6, dep: [], discipline: 'eem' },
            { id: 'E', name: 'SimÃ¼lasyon OrtamÄ± Kurulumu', sorumlu: 'BM 1', start: 1, duration: 6, dep: [], discipline: 'bm' },
            { id: 'B', name: 'UÃ§uÅŸ Kontrol ve Kalibrasyon', sorumlu: 'EEM 1', start: 7, duration: 5, dep: ['A'], discipline: 'eem' },
            { id: 'D', name: 'IoFT HaberleÅŸme AltyapÄ±sÄ±', sorumlu: 'BM 2 / EEM 2', start: 7, duration: 8, dep: ['A'], discipline: 'eem' },
            { id: 'C', name: 'Yapay ZekÃ¢ (GÃ¶rÃ¼ntÃ¼ Ä°ÅŸleme)', sorumlu: 'BM 1', start: 7, duration: 10, dep: ['E'], discipline: 'bm' },
            
            // FAZ 2: ALGORÄ°TMA VE ENTEGRASYON (Hafta 17-30)
            { id: 'F', name: 'Otonom GÃ¼dÃ¼m ve DalÄ±ÅŸ AlgoritmasÄ±', sorumlu: 'BM 2', start: 17, duration: 10, dep: ['C', 'E'], discipline: 'bm' },
            { id: 'G', name: 'SimÃ¼lasyon Entegrasyonu ve Testleri', sorumlu: 'BM 2 (Lider)', start: 27, duration: 8, dep: ['C', 'D', 'F'], discipline: 'bm' },
            
            // FAZ 3: SAHA UÃ‡UÅLARI VE VERÄ° TOPLAMA (Hafta 35-46)
            { id: 'H1', name: 'Temel UÃ§uÅŸ & DonanÄ±m Testleri', sorumlu: 'EEM 1 / EEM 2', start: 35, duration: 4, dep: ['B', 'G'], discipline: 'eem' },
            { id: 'H2', name: 'Entegre Saha GÃ¶rev Testleri', sorumlu: 'EEM 1 (Lider)', start: 39, duration: 8, dep: ['H1'], discipline: 'eem' },
            
            // FAZ 4: ANALÄ°Z VE KAPANIÅ (Hafta 47-52)
            { id: 'I', name: 'Analiz, Raporlama ve Makale TaslaÄŸÄ±', sorumlu: 'BM 1 (Lider)', start: 47, duration: 6, dep: ['H2'], discipline: 'bm' }
        ],
        roles: [
            { 
                id: 'bm1',
                title: 'BM 1: GÃ¶rÃ¼ntÃ¼ Ä°ÅŸleme & SimÃ¼lasyon', 
                icon: 'ğŸ§ ',
                tasks: ['E', 'C', 'I'],
                description: 'Yapay zekÃ¢, gÃ¶rÃ¼ntÃ¼ iÅŸleme algoritmalarÄ± ve projenin sanal test ortamÄ±nÄ±n kurulumundan sorumludur.'
            },
            { 
                id: 'bm2',
                title: 'BM 2: Otonom GÃ¼dÃ¼m & AÄŸ YazÄ±lÄ±mÄ±', 
                icon: 'ğŸ’»',
                tasks: ['D', 'F', 'G'],
                description: 'Ä°HA\'larÄ±n otonom hareket algoritmalarÄ±, aralarÄ±ndaki iletiÅŸim yazÄ±lÄ±mÄ± ve tÃ¼m sistemin entegrasyonundan sorumludur.'
            },
            { 
                id: 'eem1',
                title: 'EEM 1: Mekanik & UÃ§uÅŸ Kontrol', 
                icon: 'ğŸ› ï¸',
                tasks: ['A', 'B', 'H1', 'H2'],
                description: 'Ä°HA\'larÄ±n fiziksel montajÄ±, uÃ§uÅŸ kontrol kartlarÄ±nÄ±n ayarlanmasÄ± ve saha testlerinin liderliÄŸinden sorumludur.'
            },
            { 
                id: 'eem2',
                title: 'EEM 2: HaberleÅŸme & SensÃ¶rler', 
                icon: 'âš¡',
                tasks: ['D', 'G', 'H1', 'H2'],
                description: 'HaberleÅŸme donanÄ±mlarÄ±, kamera ve sensÃ¶rlerin entegrasyonu ile saha testleri sÄ±rasÄ±nda veri takibinden sorumludur.'
            }
        ],
        details: [
            { 
                id: 'A', 
                content: `
                    <h4 class="font-semibold text-sky-600 mt-2 mb-1">AmaÃ§:</h4> Ä°ki adet sabit kanatlÄ± Ä°HA platformunun fiziksel olarak uÃ§uÅŸa hazÄ±r hale getirilmesi ve aviyonik bileÅŸenlerin montajÄ±nÄ±n tamamlanmasÄ±.
                    <h4 class="font-semibold text-sky-600 mt-2 mb-1">Temel Ã‡Ä±ktÄ±lar:</h4> 
                    <ul class="list-disc list-inside ml-4 text-sm">
                        <li>Ä°HA GÃ¶vdelerinin Mekanik Montaj Raporu.</li>
                        <li>Motor, ESC (SkyWalker 80A), Servo motor (MG90S) ve gÃ¼Ã§ sistemlerinin (14.8V Lipo Batarya, UBEC) gÃ¼venli kablolama diyagramÄ± ve test protokolÃ¼.</li>
                    </ul>
                    <h4 class="font-semibold text-sky-600 mt-2 mb-1">BaÅŸarÄ± Kriteri:</h4> TÃ¼m donanÄ±m bileÅŸenlerinin (Motor, ESC, Servo) RC Kumanda ile manuel olarak kontrol edilebilir ve test voltajlarÄ±nda sorunsuz Ã§alÄ±ÅŸabilir durumda olmasÄ±.
                `,
                subTasks: [
                    { key: 'A1', description: 'Mekanik MontajÄ±n TamamlanmasÄ± ve Test Raporu' },
                    { key: 'A2', description: 'Motor, ESC ve Servo KablolamasÄ±nÄ±n GÃ¼venlik KontrolÃ¼' },
                    { key: 'A3', description: 'GÃ¼Ã§ Sistemlerinin (Batarya, UBEC) Ä°lk Ã‡alÄ±ÅŸtÄ±rma Testi' }
                ]
            },
            { 
                id: 'E', 
                content: `
                    <h4 class="font-semibold text-sky-600 mt-2 mb-1">AmaÃ§:</h4> Projenin algoritmik geliÅŸtirme ve Ã¶n test aÅŸamalarÄ± iÃ§in gerÃ§ekÃ§i bir sanal ortamÄ±n kurulmasÄ±.
                    <h4 class="font-semibold text-sky-600 mt-2 mb-1">Temel Ã‡Ä±ktÄ±lar:</h4> 
                    <ul class="list-disc list-inside ml-4 text-sm">
                        <li>GÃ¶rev bilgisayarlarÄ±nda (RPi/Jetson) ROS2 (Robot Operating System 2) ve Gazebo simÃ¼lasyon yazÄ±lÄ±mlarÄ±nÄ±n stabil kurulumu.</li>
                        <li>Sabit kanatlÄ± Ä°HA (KeÅŸif/Kamikaze) modellerinin Gazebo ortamÄ±na entegrasyonu. Sanal gimbal, GPS ve kamera arayÃ¼zlerinin ROS2 topic'ler Ã¼zerinden Ã§alÄ±ÅŸÄ±r hale getirilmesi.</li>
                    </ul>
                    <h4 class="font-semibold text-sky-600 mt-2 mb-1">BaÅŸarÄ± Kriteri:</h4> Ä°ki Ä°HA modelinin de Gazebo'da otonom uÃ§uÅŸa uygun bir ÅŸekilde simÃ¼le edilebilir ve ROS2 Ã¼zerinden kontrol edilebilir olmasÄ±.
                `,
                subTasks: [
                    { key: 'E1', description: 'ROS2 ve Gazebo Kurulumu' },
                    { key: 'E2', description: 'Ä°HA Modellerinin Gazebo\'ya Entegrasyonu' },
                    { key: 'E3', description: 'Sanal SensÃ¶r ve Kontrol ArayÃ¼zlerinin ROS2 Ãœzerinde DoÄŸrulanmasÄ±' }
                ]
            },
            { 
                id: 'B', 
                content: `
                    <h4 class="font-semibold text-sky-600 mt-2 mb-1">AmaÃ§:</h4> Pixhawk otopilotlarÄ±n uÃ§uÅŸa hazÄ±rlanmasÄ± ve temel stabilite ayarlarÄ±nÄ±n yapÄ±lmasÄ±.
                    <h4 class="font-semibold text-sky-600 mt-2 mb-1">Temel Ã‡Ä±ktÄ±lar:</h4> 
                    <ul class="list-disc list-inside ml-4 text-sm">
                        <li>PX4 uÃ§uÅŸ kontrol yazÄ±lÄ±mÄ±nÄ±n yÃ¼klenmesi ve tÃ¼m sensÃ¶r (IMU, GPS, Pusula) kalibrasyonlarÄ±nÄ±n tamamlanmasÄ±.</li>
                        <li>UÃ§uÅŸ modlarÄ±nÄ±n (Stabilize, Otonom, GÃ¶rev) ayarlanmasÄ± ve RC Kumanda ile tam uyumluluk testi.</li>
                    </ul>
                    <h4 class="font-semibold text-sky-600 mt-2 mb-1">BaÅŸarÄ± Kriteri:</h4> Ä°HA'larÄ±n yer testlerinde (motor, kontrol yÃ¼zeyleri) hatasÄ±z tepki vermesi ve Pixhawk'Ä±n uÃ§uÅŸ Ã¶ncesi tÃ¼m kontrol listelerini (pre-flight checks) geÃ§mesi.
                `,
                 subTasks: [
                    { key: 'B1', description: 'PX4 YazÄ±lÄ±m YÃ¼klemesi ve SensÃ¶r Kalibrasyonu' },
                    { key: 'B2', description: 'UÃ§uÅŸ ModlarÄ± TanÄ±mlanmasÄ± ve Kontrol Testleri' },
                    { key: 'B3', description: 'RC Kumanda Uyum Testleri ve GÃ¼venlik Kontrolleri' }
                ]
            },
            { 
                id: 'D', 
                content: `
                    <h4 class="font-semibold text-sky-600 mt-2 mb-1">AmaÃ§:</h4> Merkeziyetsiz Ä°HA-Ä°HA ve Ä°HA-Bulut iletiÅŸim altyapÄ±sÄ±nÄ±n donanÄ±msal ve yazÄ±lÄ±msal olarak kurulmasÄ±.
                    <h4 class="font-semibold text-sky-600 mt-2 mb-1">Temel Ã‡Ä±ktÄ±lar:</h4> 
                    <ul class="list-disc list-inside ml-4 text-sm">
                        <li>LoRa modÃ¼llerinin (SX1262 HAT) ve GSM modÃ¼lÃ¼nÃ¼n (SIM808) gÃ¶rev bilgisayarÄ±na entegrasyonu ve sÃ¼rÃ¼cÃ¼ kurulumu.</li>
                        <li>Ä°HA-Ä°HA arasÄ± koordinat veri paketlerini iÅŸleyen ve minimum 50ms gecikmeyi hedefleyen LoRa iletiÅŸim protokolÃ¼ yazÄ±lÄ±mÄ±.</li>
                        <li>KeÅŸif Ä°HA'sÄ±ndan telemetri verilerini bulut platformuna aktaran GSM/MQTT yazÄ±lÄ±mÄ±nÄ±n geliÅŸtirilmesi.</li>
                    </ul>
                    <h4 class="font-semibold text-sky-600 mt-2 mb-1">BaÅŸarÄ± Kriteri:</h4> LoRa Ã¼zerinden iki Ä°HA arasÄ±nda %95 Ã¼zeri veri bÃ¼tÃ¼nlÃ¼ÄŸÃ¼ ile 1 km menzilde veri transferinin saÄŸlanmasÄ±.
                `,
                subTasks: [
                    { key: 'D1', description: 'LoRa/GSM DonanÄ±m ve SÃ¼rÃ¼cÃ¼ Entegrasyonu' },
                    { key: 'D2', description: 'LoRa Ä°letiÅŸim ProtokolÃ¼ YazÄ±lÄ±m GeliÅŸtirme' },
                    { key: 'D3', description: 'GSM/MQTT Telemetri AktarÄ±m YazÄ±lÄ±mÄ±' },
                    { key: 'D4', description: 'Ä°lk Gecikme ve Menzil Testleri' }
                ]
            },
            { 
                id: 'C', 
                content: `
                    <h4 class="font-semibold text-sky-600 mt-2 mb-1">AmaÃ§:</h4> YÃ¼ksek doÄŸrulukta hedef tespiti ve konumlandÄ±rma iÃ§in hibrit yapay zekÃ¢ algoritmalarÄ±nÄ±n geliÅŸtirilmesi.
                    <h4 class="font-semibold text-sky-600 mt-2 mb-1">Temel Ã‡Ä±ktÄ±lar:</h4> 
                    <ul class="list-disc list-inside ml-4 text-sm">
                        <li>YOLO tabanlÄ± nesne tespit modelinin prototip QR kod tespiti iÃ§in hazÄ±rlanmasÄ± ve optimizasyonu.</li>
                        <li>GÃ¶rÃ¼ntÃ¼deki potansiyel hedef bÃ¶lgelerini hÄ±zlÄ±ca daraltan Adaptive Thresholding ve kenar algÄ±lama Ã¶n iÅŸlem kodunun yazÄ±lmasÄ±.</li>
                        <li>Tespit edilen hedefin kamera parametreleri ve Ä°HA konumu kullanÄ±larak GPS koordinatÄ±nÄ± ($\mathbf{\pm2}$ metre hassasiyetle) hesaplayan Fotogrametrik KonumlandÄ±rma ModÃ¼lÃ¼.</li>
                    </ul>
                    <h4 class="font-semibold text-sky-600 mt-2 mb-1">BaÅŸarÄ± Kriteri:</h4> SimÃ¼lasyon ortamÄ±nda QR kod hedeflerini $\mathbf{\%90}$ Ã¼zeri doÄŸrulukla ve $\mathbf{\pm2}$ metre konum hassasiyetiyle tespit edebilen entegre yazÄ±lÄ±m modÃ¼lÃ¼.
                `,
                subTasks: [
                    { key: 'C1', description: 'YOLO Modelinin QR Kod iÃ§in EÄŸitilmesi ve Optimizasyonu' },
                    { key: 'C2', description: 'Adaptive Thresholding Ã–n Ä°ÅŸlem Kodunun GeliÅŸtirilmesi' },
                    { key: 'C3', description: 'Fotogrametrik KonumlandÄ±rma ModÃ¼lÃ¼ YazÄ±lÄ±mÄ±' }
                ]
            },
            { 
                id: 'F', 
                content: `
                    <h4 class="font-semibold text-sky-600 mt-2 mb-1">AmaÃ§:</h4> Kamikaze Ä°HA'sÄ±nÄ±n aldÄ±ÄŸÄ± koordinatlara gÃ¶re otonom ve kararlÄ± bir saldÄ±rÄ± rotasÄ± planlayÄ±p icra etmesi.
                    <h4 class="font-semibold text-sky-600 mt-2 mb-1">Temel Ã‡Ä±ktÄ±lar:</h4> 
                    <ul class="list-disc list-inside ml-4 text-sm">
                        <li>Hedef koordinatlarÄ±na gÃ¶re en uygun dalÄ±ÅŸ aÃ§Ä±sÄ±nÄ± ve hÄ±zÄ±nÄ± belirleyen Rota Planlama AlgoritmasÄ±.</li>
                        <li>PX4'Ã¼n gÃ¼dÃ¼m komutlarÄ± kullanÄ±larak hedefe $\mathbf{\pm5}$ metre hassasiyetle yaklaÅŸmayÄ± saÄŸlayan Otonom GÃ¼dÃ¼m ve Kontrol ModÃ¼lÃ¼.</li>
                        <li>GÃ¶rev sonrasÄ± Ä°HA'nÄ±n gÃ¼venli irtifaya tÄ±rmanmasÄ±nÄ± ve geri dÃ¶nmesini saÄŸlayan Kurtarma ProsedÃ¼rÃ¼ yazÄ±lÄ±mÄ±.</li>
                    </ul>
                    <h4 class="font-semibold text-sky-600 mt-2 mb-1">BaÅŸarÄ± Kriteri:</h4> SimÃ¼lasyon ortamÄ±nda otonom dalÄ±ÅŸÄ±n hedeften sapma miktarÄ±nÄ±n sÃ¼rekli olarak $\mathbf{<5}$ metre aralÄ±ÄŸÄ±nda kalmasÄ±.
                `,
                subTasks: [
                    { key: 'F1', description: 'Rota Planlama AlgoritmasÄ± GeliÅŸtirilmesi' },
                    { key: 'F2', description: 'Otonom GÃ¼dÃ¼m ve Kontrol ModÃ¼lÃ¼ YazÄ±lÄ±mÄ±' },
                    { key: 'F3', description: 'Kurtarma ProsedÃ¼rÃ¼ YazÄ±lÄ±mÄ±' }
                ]
            },
            { 
                id: 'G', 
                content: `
                    <h4 class="font-semibold text-sky-600 mt-2 mb-1">AmaÃ§:</h4> TÃ¼m yazÄ±lÄ±mlarÄ±n (C, D, F) sanal ortamda bir araya getirilerek uÃ§tan uca senaryonun test edilmesi ve optimizasyonu.
                    <h4 class="font-semibold text-sky-600 mt-2 mb-1">Temel Ã‡Ä±ktÄ±lar:</h4> 
                    <ul class="list-disc list-inside ml-4 text-sm">
                        <li>KeÅŸif (Yapay ZekÃ¢) ve Kamikaze (GÃ¼dÃ¼m) Ä°HA'larÄ± arasÄ±ndaki veri akÄ±ÅŸÄ±nÄ± gÃ¶steren SimÃ¼lasyon Veri Seti.</li>
                        <li>SimÃ¼lasyon Hata AyÄ±klama Raporu ve Algoritma Optimizasyon KayÄ±tlarÄ±.</li>
                        <li>SimÃ¼lasyon BaÅŸarÄ± Raporu.</li>
                    </ul>
                    <h4 class="font-semibold text-sky-600 mt-2 mb-1">BaÅŸarÄ± Kriteri:</h4> SimÃ¼lasyon ortamÄ±nda KeÅŸif-Tespit-AktarÄ±m-YaklaÅŸÄ±m senaryosunun genel gÃ¶rev baÅŸarÄ± oranÄ±nÄ±n $\mathbf{\%90}$ ve Ã¼zerinde olmasÄ±. Bu, saha testleri iÃ§in Ã¶n ÅŸarttÄ±r.
                `,
                subTasks: [
                    { key: 'G1', description: 'TÃ¼m YazÄ±lÄ±mlarÄ±n ROS2/Gazebo OrtamÄ±na Entegrasyonu' },
                    { key: 'G2', description: 'UÃ§tan Uca SimÃ¼lasyon Senaryosu Testi' },
                    { key: 'G3', description: 'Hata AyÄ±klama ve %90 BaÅŸarÄ± OranÄ± Optimizasyonu' }
                ]
            },
            { 
                id: 'H1', 
                content: `
                    <h4 class="font-semibold text-sky-600 mt-2 mb-1">AmaÃ§:</h4> Sistemin ayrÄ± ayrÄ± temel iÅŸlevselliÄŸini gerÃ§ek donanÄ±m ve uÃ§uÅŸ koÅŸullarÄ±nda doÄŸrulamak.
                    <h4 class="font-semibold text-sky-600 mt-2 mb-1">Temel Ã‡Ä±ktÄ±lar:</h4> 
                    <ul class="list-disc list-inside ml-4 text-sm">
                        <li>KeÅŸif Ä°HA'sÄ±nÄ±n otonom kalkÄ±ÅŸ, belirli bir rotada stabil uÃ§uÅŸ ve iniÅŸ testleri.</li>
                        <li>LoRa/GSM modÃ¼lleri Ã¼zerinden yer istasyonuna kesintisiz telemetri veri aktarÄ±m testleri.</li>
                        <li>Yerel alan kamerasÄ± (QR kod) tespit ve koordinat hesaplama hÄ±zÄ±nÄ±n statik yer testleri.</li>
                    </ul>
                    <h4 class="font-semibold text-sky-600 mt-2 mb-1">BaÅŸarÄ± Kriteri:</h4> Her iki Ä°HA'nÄ±n da tÃ¼m otonom uÃ§uÅŸ modlarÄ±nda stabil ve gÃ¼venli ÅŸekilde uÃ§uÅŸ yapabildiÄŸinin kanÄ±tlanmasÄ±.
                `,
                subTasks: [
                    { key: 'H1.1', description: 'KeÅŸif Ä°HA Temel Otonom UÃ§uÅŸ Testleri' },
                    { key: 'H1.2', description: 'Kamikaze Ä°HA Temel Otonom UÃ§uÅŸ Testleri' },
                    { key: 'H1.3', description: 'LoRa/GSM Telemetri AktarÄ±mÄ±nÄ±n Saha DoÄŸrulamasÄ±' }
                ]
            },
            { 
                id: 'H2', 
                content: `
                    <h4 class="font-semibold text-sky-600 mt-2 mb-1">AmaÃ§:</h4> TÃ¼m sistemin gerÃ§ek uÃ§uÅŸ koÅŸullarÄ±nda entegre olarak tam gÃ¶rev senaryosunu gerÃ§ekleÅŸtirmesi.
                    <h4 class="font-semibold text-sky-600 mt-2 mb-1">Temel Ã‡Ä±ktÄ±lar:</h4> 
                    <ul class="list-disc list-inside ml-4 text-sm">
                        <li>GerÃ§ek zamanlÄ± hedef tespiti ve aktarÄ±mÄ± gecikme (Latency) metrikleri.</li>
                        <li>Kamikaze Ä°HA'sÄ±nÄ±n hedefe yaklaÅŸma hassasiyeti (metre bazÄ±nda sapma) kayÄ±tlarÄ±.</li>
                        <li>UÃ§uÅŸ sÄ±rasÄ±nda elde edilen tÃ¼m telemetri ve gÃ¶rev verilerinin veri tabanÄ± kaydÄ±.</li>
                    </ul>
                    <h4 class="font-semibold text-sky-600 mt-2 mb-1">BaÅŸarÄ± Kriteri:</h4> Tam gÃ¶rev senaryosunun tekrarlanabilir ÅŸekilde $\mathbf{\%80}$ ve Ã¼zeri genel gÃ¶rev baÅŸarÄ± oranÄ±yla tamamlanmasÄ±.
                `,
                 subTasks: [
                    { key: 'H2.1', description: 'UÃ§tan Uca Saha Testi 1 (DÃ¼ÅŸÃ¼k RÃ¼zgar)' },
                    { key: 'H2.2', description: 'UÃ§tan Uca Saha Testi 2 (Hafif RÃ¼zgar/DeÄŸiÅŸen KoÅŸullar)' },
                    { key: 'H2.3', description: 'GÃ¶rev BaÅŸarÄ± OranÄ± ve Hassasiyet Metriklerinin ToplanmasÄ±' }
                ]
            },
            { 
                id: 'I', 
                content: `
                    <h4 class="font-semibold text-sky-600 mt-2 mb-1">AmaÃ§:</h4> Elde edilen tÃ¼m verilerin analiz edilmesi ve projenin bilimsel Ã§Ä±ktÄ±larÄ±nÄ±n oluÅŸturulmasÄ±.
                    <h4 class="font-semibold text-sky-600 mt-2 mb-1">Temel Ã‡Ä±ktÄ±lar:</h4> 
                    <ul class="list-disc list-inside ml-4 text-sm">
                        <li>SimÃ¼lasyon ve Saha SonuÃ§larÄ±nÄ±n KarÅŸÄ±laÅŸtÄ±rmalÄ± Performans Analiz Raporu.</li>
                        <li>Proje SonuÃ§ Raporu ve Nihai Proje Sunumu.</li>
                        <li>En az 1 adet ulusal/uluslararasÄ± konferans bildirisi veya makale taslaÄŸÄ±.</li>
                    </ul>
                    <h4 class="font-semibold text-sky-600 mt-2 mb-1">BaÅŸarÄ± Kriteri:</h4> TÃ¼m hipotezlerin toplanan nicel verilerle desteklenerek veya Ã§Ã¼rÃ¼tÃ¼lerek bilimsel bir dille belgelenmesi.
                `,
                subTasks: [
                    { key: 'I1', description: 'TÃ¼m Saha Verilerinin Ä°statistiksel Analizi' },
                    { key: 'I2', description: 'SonuÃ§ Raporu TaslaÄŸÄ±nÄ±n HazÄ±rlanmasÄ±' },
                    { key: 'I3', description: 'Makale veya Bildiri TaslaÄŸÄ±nÄ±n OluÅŸturulmasÄ±' }
                ]
            }
        ]
    };

    document.addEventListener('DOMContentLoaded', () => {
        // Firebase Auth baÅŸlatÄ±ldÄ±ktan sonra JS kodu devam eder.
        window.initializeFirebaseAndAuth().then(() => {
             // Firebase'in baÅŸlatÄ±ldÄ±ÄŸÄ±ndan emin olduktan sonra Gantt/Accordion oluÅŸturulur.
             renderProjectUI();
        });


        const ganttChart = document.getElementById('gantt-chart');
        const ganttHeaderContainer = document.querySelector('.gantt-grid');
        const rolesContainer = document.querySelector('#gorev-dagilimi .grid');
        const accordionContainer = document.getElementById('accordion-container');
        
        // Generate Gantt Headers (1 to 52)
        for (let i = 1; i <= 52; i++) {
            const headerCell = document.createElement('div');
            // HaftalarÄ± daha anlaÅŸÄ±lÄ±r gÃ¶stermek iÃ§in her 4 haftada bir numara yazdÄ±r
            headerCell.textContent = (i % 4 === 0) ? `${i}.H` : '';
            headerCell.className = `text-xs text-center ${(i % 4 === 0) ? 'font-bold' : ''}`;
            ganttHeaderContainer.appendChild(headerCell);
        }

        function renderProjectUI() {
            // Clear existing content before re-rendering
            accordionContainer.innerHTML = '';
            
            // Generate Gantt Chart & Accordion
            window.projectData.tasks.forEach(task => {
                // GANTT CHART RENDERING (DÃœZELTME YAPILDI)
                const endLine = task.start + task.duration;
                const label = document.createElement('div');
                label.className = 'gantt-label bg-slate-50 rounded-l-lg font-medium text-sm text-slate-700';
                label.textContent = `Ä°P ${task.id}`;

                const grid = document.createElement('div');
                grid.className = 'gantt-grid';

                const bar = document.createElement('div');
                // Removed 'text-xs' class as font size is handled by style block (0.6rem)
                bar.className = `gantt-bar bg-${task.discipline} text-white flex items-center justify-center p-1 rounded-lg h-[40px] shadow`;
                // Grid-column Ã¶zelliÄŸi doÄŸrudan atanarak CSS deÄŸiÅŸkeni baÄŸÄ±mlÄ±lÄ±ÄŸÄ± giderildi
                bar.style.gridColumn = `${task.start} / ${endLine}`; 
                bar.textContent = task.name;
                bar.dataset.taskId = task.id;
                bar.dataset.discipline = task.discipline;

                grid.appendChild(bar);
                ganttChart.appendChild(label);
                ganttChart.appendChild(grid);
                
                // Accordion Item
                const detail = window.projectData.details.find(d => d.id === task.id);
                const accordionItem = document.createElement('div');
                accordionItem.id = `task-card-${task.id}`;
                accordionItem.className = `task-card bg-white rounded-2xl shadow-lg border-l-8 border-${task.discipline} transition-all duration-300 overflow-hidden`;

                // Sub-task checkboxes HTML generation
                let subTasksHtml = '';
                if (detail && detail.subTasks && detail.subTasks.length > 0) {
                    subTasksHtml = `
                        <h5 class="font-bold text-lg text-slate-700 mb-3 mt-4">DetaylÄ± Ã‡Ä±ktÄ±lar / Alt GÃ¶revler:</h5>
                        <div class="space-y-2 mb-4">
                    `;
                    detail.subTasks.forEach(subTask => {
                        subTasksHtml += `
                            <div class="flex items-start">
                                <input type="checkbox" id="sub-A${subTask.key}" data-task-id="${task.id}" class="sub-task-checkbox h-5 w-5 text-green-600 border-gray-300 rounded focus:ring-green-500 cursor-pointer mt-1" 
                                       onchange="window.saveTaskStatus('${task.id}', 'sub-${subTask.key}', this.checked);">
                                <label for="sub-A${subTask.key}" class="sub-task-label ml-3 text-base text-slate-700 cursor-pointer">${subTask.description}</label>
                            </div>
                        `;
                    });
                    subTasksHtml += '</div>';
                }

                accordionItem.innerHTML = `
                    <div class="accordion-header p-5 cursor-pointer flex justify-between items-center">
                        <div class="flex items-center gap-3">
                            <h3 class="font-bold text-lg">${task.id}: ${task.name}</h3>
                            <span class="text-sm text-slate-500">| Sorumlu: ${task.sorumlu} | SÃ¼re: ${task.duration} Hafta</span>
                        </div>
                        <span class="text-2xl font-light text-slate-500 accordion-icon">+</span>
                    </div>
                    <div class="accordion-content">
                        <div class="p-5 pt-0 text-slate-600">
                             <!-- DetaylÄ± Ä°Ã§erik -->
                             ${detail.content}
                             
                             <div class="mt-6 pt-4 border-t border-slate-200">
                                <h5 class="font-bold text-lg text-slate-700 mb-3">GÃ¶rev Takibi (KalÄ±cÄ± KayÄ±t)</h5>
                                
                                ${subTasksHtml}

                                <div class="flex items-start gap-4 mb-4 pt-4 border-t border-slate-100">
                                    <input type="checkbox" id="completed-A${task.id}" data-task-id="${task.id}" class="h-6 w-6 text-green-600 border-gray-300 rounded focus:ring-green-500 cursor-pointer" disabled>
                                    <label for="completed-A${task.id}" class="text-lg font-medium text-green-700">Ä°ÅŸ Paketi TamamlandÄ± (TÃ¼m Alt GÃ¶revler Bitince Otomatik)</label>
                                </div>
                                <label for="notes-A${task.id}" class="block text-sm font-medium text-slate-700 mb-1">GÃ¶rev NotlarÄ± (Maksimum 500 karakter):</label>
                                <textarea id="notes-A${task.id}" data-task-id="${task.id}" rows="4" maxlength="500"
                                          class="w-full border border-slate-300 rounded-lg p-3 text-sm focus:border-sky-500 focus:ring-sky-500 transition"
                                          onchange="window.saveTaskStatus('${task.id}', 'notes', this.value);"></textarea>
                            </div>
                        </div>
                    </div>
                `;
                accordionContainer.appendChild(accordionItem);
            });

            // Generate Role Cards (no change, kept for completeness)
            window.projectData.roles.forEach(role => {
                const card = document.createElement('div');
                card.className = 'bg-white p-6 rounded-2xl shadow-lg flex flex-col';
                card.innerHTML = `
                    <div class="flex items-center gap-4 mb-4">
                        <span class="text-4xl">${role.icon}</span>
                        <h3 class="text-xl font-bold">${role.title}</h3>
                    </div>
                    <p class="text-slate-600 mb-4 flex-grow">${role.description}</p>
                    <button data-role-id="${role.id}" class="filter-btn mt-auto w-full bg-slate-200 text-slate-700 font-bold py-2 px-4 rounded-lg transition hover:bg-sky-200">
                        GÃ¶revleri Vurgula
                    </button>
                `;
                rolesContainer.appendChild(card);
            });
            
            // Re-apply event listeners for accordion and filtering (no changes here)
            // Accordion Logic
            accordionContainer.addEventListener('click', (e) => {
                const header = e.target.closest('.accordion-header');
                if (!header) return;

                const accordionItem = header.parentElement;
                const content = accordionItem.querySelector('.accordion-content');
                // Simgeyi seÃ§mek iÃ§in yeni sÄ±nÄ±fÄ± kullan
                const icon = header.querySelector('.accordion-icon');
                const isOpen = content.style.maxHeight;
                
                // Close all others
                accordionContainer.querySelectorAll('.accordion-content').forEach(c => c.style.maxHeight = null);
                accordionContainer.querySelectorAll('.accordion-icon').forEach(i => i.classList.remove('rotate-45'));

                if (!isOpen) {
                    content.style.maxHeight = content.scrollHeight + "px";
                    icon.classList.add('rotate-45');
                }
            });

            // Gantt Bar Click Logic
            ganttChart.addEventListener('click', (e) => {
                const bar = e.target.closest('.gantt-bar');
                if(!bar) return;

                const taskId = bar.dataset.taskId;
                const targetCard = document.getElementById(`task-card-${taskId}`);

                if (targetCard) {
                    // Remove highlight from all cards
                    document.querySelectorAll('.task-card').forEach(card => card.classList.remove('highlight'));
                    
                    // Add highlight to target card
                    targetCard.classList.add('highlight');
                    targetCard.scrollIntoView({ behavior: 'smooth', block: 'center' });

                    // Open the accordion
                    const content = targetCard.querySelector('.accordion-content');
                     if (!content.style.maxHeight) {
                        targetCard.querySelector('.accordion-header').click();
                     }
                }
            });
            
            // Filter Logic - YenilenmiÅŸ ve Ä°yileÅŸtirilmiÅŸ
            let activeFilter = null;
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    // window.projectData kullanÄ±ldÄ±
                    const roleId = btn.dataset.roleId;
                    const roleTasks = window.projectData.roles.find(r => r.id === roleId).tasks;
                    const ganttBars = document.querySelectorAll('.gantt-bar');
                    
                    if (activeFilter === roleId) {
                        // Filtreyi KaldÄ±r
                        ganttBars.forEach(bar => bar.classList.remove('gantt-bar-dimmed'));
                        btn.classList.remove('filter-active');
                        activeFilter = null;
                    } else {
                        // DiÄŸer butonlarÄ± deaktif et
                         document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('filter-active'));
                         
                        // Bu filtreyi aktif et
                        btn.classList.add('filter-active');
                        activeFilter = roleId;

                        ganttBars.forEach(bar => {
                            if (roleTasks.includes(bar.dataset.taskId)) {
                                bar.classList.remove('gantt-bar-dimmed'); // Vurgula
                            } else {
                                bar.classList.add('gantt-bar-dimmed'); // SolgunlaÅŸtÄ±r
                            }
                        });
                    }
                });
            });

            // Mobile Menu
            const mobileMenuButton = document.getElementById('mobile-menu-button');
            const mobileMenu = document.getElementById('mobile-menu');
            mobileMenuButton.addEventListener('click', () => {
                mobileMenu.classList.toggle('hidden');
            });

            // Close mobile menu on link click
            mobileMenu.addEventListener('click', (e) => {
                if (e.target.tagName === 'A') {
                    mobileMenu.classList.add('hidden');
                }
            });
        }
    });
</script>

</body>
</html>
