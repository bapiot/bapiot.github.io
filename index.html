<!DOCTYPE html>
<html lang="tr" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Yapay Zekâ Destekli İHA Projesi - Kontrol Paneli</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Slate & Sky -->
    <!-- Application Structure Plan: A single-page dashboard with header navigation to jump between sections: Project Summary, an interactive Gantt-style Timeline, a Role-based Task Distribution view, and a Technical Details accordion. This structure was chosen to allow both high-level project tracking (timeline) and role-specific views (task cards), facilitating easy navigation and reducing information overload for team members. Clicking on elements cross-references information between sections. -->
    <!-- Visualization & Content Choices: Timeline -> Goal: Show Change/Relationships -> Viz: HTML/CSS Gantt Chart -> Interaction: Click task to see details, filter by role -> Justification: Most intuitive way to visualize a project plan. Task Details -> Goal: Inform -> Viz: Accordion List -> Interaction: Click to expand/collapse -> Justification: Hides complexity by default. Role Cards -> Goal: Organize -> Viz: HTML Cards -> Interaction: Click to filter timeline -> Justification: Provides a personalized view for each team member. Libraries: Vanilla JS, Tailwind CSS. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f1f5f9;
        }
        .gantt-chart-container {
            display: grid;
            grid-template-columns: 150px 1fr;
            gap: 8px;
        }
        .gantt-grid {
            display: grid;
            grid-template-columns: repeat(52, minmax(0, 1fr)); /* 52 Haftalık Plan */
            gap: 1px;
            padding: 8px 0;
        }
        .gantt-bar {
            grid-column: var(--start) / span var(--duration);
            transition: all 0.3s ease;
            cursor: pointer;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.06);
            font-size: 0.65rem; /* Haftalık sütunlar daralınca yazı küçültüldü */
        }
        .gantt-bar:hover {
            transform: scale(1.02);
            opacity: 1 !important;
        }
        .gantt-bar-dimmed {
             opacity: 0.3;
             filter: grayscale(80%);
        }
        .gantt-label {
            height: 40px; 
            display: flex;
            align-items: center;
            padding-left: 8px;
        }
        .header-underline {
            position: relative;
            padding-bottom: 8px;
        }
        .header-underline::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 50px;
            height: 3px;
            background-color: #0284c7;
        }
        .task-card.highlight {
            transform: scale(1.03);
            box-shadow: 0 0 25px rgba(2, 132, 199, 0.4);
            border-color: #0284c7;
        }
        .accordion-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease-out;
        }
        .bg-bm { background-color: #0ea5e9; } /* sky-500 */
        .border-bm { border-left-color: #0ea5e9; }
        .bg-eem { background-color: #10b981; } /* emerald-500 */
        .border-eem { border-left-color: #10b981; }
        .filter-active {
            background-color: #0284c7 !important;
            color: white !important;
        }
    </style>
</head>
<body class="text-slate-800">

    <header class="bg-white/80 backdrop-blur-lg sticky top-0 z-50 shadow-md">
        <div class="container mx-auto px-6 py-4 flex justify-between items-center">
            <h1 class="text-xl md:text-2xl font-bold text-slate-900">
                🚀 <span class="hidden sm:inline">İHA Projesi Kontrol Paneli</span>
            </h1>
            <nav class="hidden md:flex space-x-6 text-base font-medium">
                <a href="#proje-akisi" class="text-slate-600 hover:text-sky-600 transition">Proje Akışı</a>
                <a href="#gorev-dagilimi" class="text-slate-600 hover:text-sky-600 transition">Görev Dağılımı</a>
                <a href="#teknik-detaylar" class="text-slate-600 hover:text-sky-600 transition">Teknik Detaylar</a>
            </nav>
            <div id="mobile-menu-button" class="md:hidden text-2xl cursor-pointer">☰</div>
        </div>
        <div id="mobile-menu" class="hidden md:hidden bg-white px-6 pb-4">
             <a href="#proje-akisi" class="block py-2 text-slate-600 hover:text-sky-600 transition">Proje Akışı</a>
             <a href="#gorev-dagilimi" class="block py-2 text-slate-600 hover:text-sky-600 transition">Görev Dağılımı</a>
             <a href="#teknik-detaylar" class="block py-2 text-slate-600 hover:text-sky-600 transition">Teknik Detaylar</a>
        </div>
    </header>

    <main class="container mx-auto p-4 md:p-8">

        <section id="proje-akisi" class="mb-12">
            <h2 class="text-3xl font-bold mb-6 header-underline">Proje Akışı ve Zaman Çizelgesi</h2>
            <p class="mb-8 text-slate-600 max-w-3xl">Proje, 4 ana faza yayılmıştır ve toplam 52 hafta (1 yıl) sürmesi hedeflenmektedir. Aşağıdaki interaktif zaman çizelgesi, görevlerin haftalık dağılımını, sürelerini ve birbirleriyle olan ilişkilerini göstermektedir. Bir görevin detaylarını görmek için üzerine tıklayabilirsiniz.</p>
            
            <div class="bg-white p-6 rounded-2xl shadow-lg overflow-x-auto">
                <div class="min-w-[1200px]"> <!-- 52 haftaya uyum sağlaması için minimum genişlik artırıldı -->
                    <div class="gantt-chart-container mb-2">
                        <div></div>
                        <div class="gantt-grid text-xs text-center text-slate-500">
                            <!-- Gantt Headers will be generated by JS -->
                        </div>
                    </div>
                    <div id="gantt-chart" class="gantt-chart-container">
                        <!-- Gantt Rows will be generated by JS -->
                    </div>
                </div>
                 <div class="mt-4 flex flex-wrap gap-4 text-sm">
                    <div class="flex items-center gap-2"><div class="w-4 h-4 rounded-full bg-bm"></div><span>Bilgisayar Müh. (BM)</span></div>
                    <div class="flex items-center gap-2"><div class="w-4 h-4 rounded-full bg-eem"></div><span>Elektrik-Elektronik Müh. (EEM)</span></div>
                </div>
            </div>
        </section>

        <section id="gorev-dagilimi" class="mb-12">
            <h2 class="text-3xl font-bold mb-6 header-underline">Disipline Göre Görev Dağılımı</h2>
             <p class="mb-8 text-slate-600 max-w-3xl">Her ekip üyesinin projedeki ana odak alanları ve sorumlulukları aşağıda özetlenmiştir. Bir roldeki görevleri zaman çizelgesinde vurgulamak için ilgili butona tıklayın.</p>
            <div class="grid md:grid-cols-2 gap-8">
                <!-- Role cards will be generated by JS -->
            </div>
        </section>

        <section id="teknik-detaylar">
            <h2 class="text-3xl font-bold mb-6 header-underline">Teknik Detaylar ve İş Paketleri</h2>
            <p class="mb-8 text-slate-600 max-w-3xl">Her bir iş paketinin (İP) **Amacı**, **Temel Çıktıları** ve **Başarı Kriterleri** aşağıda detaylandırılmıştır. Daha fazla bilgi için başlıklara tıklayarak ilgili bölümü genişletebilirsiniz.</p>
            <div id="accordion-container" class="space-y-4">
                <!-- Accordion items will be generated by JS -->
            </div>
        </section>

    </main>
    
    <footer class="text-center py-8 text-slate-500 text-sm">
        <p>Yapay Zekâ Destekli İHA Projesi Kontrol Paneli | Abdullah Gül Üniversitesi</p>
    </footer>

<script>
const projectData = {
    // Toplam süre 52 haftaya yayıldı. Görev süreleri oransal olarak artırıldı ve daha detaylı planlandı.
    tasks: [
        // FAZ 1: HAZIRLIK VE TEMEL KURULUM (Hafta 1-8)
        { id: 'A', name: 'Mekanik Montaj ve Kablolama', sorumlu: 'EEM 1', start: 1, duration: 6, dep: [], discipline: 'eem' },
        { id: 'E', name: 'Simülasyon Ortamı Kurulumu', sorumlu: 'BM 1', start: 1, duration: 6, dep: [], discipline: 'bm' },
        { id: 'B', name: 'Uçuş Kontrol ve Kalibrasyon', sorumlu: 'EEM 1', start: 7, duration: 5, dep: ['A'], discipline: 'eem' },
        { id: 'D', name: 'IoFT Haberleşme Altyapısı', sorumlu: 'BM 2 / EEM 2', start: 7, duration: 8, dep: ['A'], discipline: 'eem' },
        { id: 'C', name: 'Yapay Zekâ (Görüntü İşleme)', sorumlu: 'BM 1', start: 7, duration: 10, dep: ['E'], discipline: 'bm' },
        
        // FAZ 2: ALGORİTMA VE ENTEGRASYON (Hafta 17-30)
        { id: 'F', name: 'Otonom Güdüm ve Dalış Algoritması', sorumlu: 'BM 2', start: 17, duration: 10, dep: ['C', 'E'], discipline: 'bm' },
        { id: 'G', name: 'Simülasyon Entegrasyonu ve Testleri', sorumlu: 'BM 2 (Lider)', start: 27, duration: 8, dep: ['C', 'D', 'F'], discipline: 'bm' },
        
        // FAZ 3: SAHA UÇUŞLARI VE VERİ TOPLAMA (Hafta 35-46)
        { id: 'H1', name: 'Temel Uçuş & Donanım Testleri', sorumlu: 'EEM 1 / EEM 2', start: 35, duration: 4, dep: ['B', 'G'], discipline: 'eem' },
        { id: 'H2', name: 'Entegre Saha Görev Testleri', sorumlu: 'EEM 1 (Lider)', start: 39, duration: 8, dep: ['H1'], discipline: 'eem' },
        
        // FAZ 4: ANALİZ VE KAPANIŞ (Hafta 47-52)
        { id: 'I', name: 'Analiz, Raporlama ve Makale Taslağı', sorumlu: 'BM 1 (Lider)', start: 47, duration: 6, dep: ['H2'], discipline: 'bm' }
    ],
    roles: [
        { 
            id: 'bm1',
            title: 'BM 1: Görüntü İşleme & Simülasyon', 
            icon: '🧠',
            tasks: ['E', 'C', 'I'],
            description: 'Yapay zekâ, görüntü işleme algoritmaları ve projenin sanal test ortamının kurulumundan sorumludur.'
        },
        { 
            id: 'bm2',
            title: 'BM 2: Otonom Güdüm & Ağ Yazılımı', 
            icon: '💻',
            tasks: ['D', 'F', 'G'],
            description: 'İHA\'ların otonom hareket algoritmaları, aralarındaki iletişim yazılımı ve tüm sistemin entegrasyonundan sorumludur.'
        },
        { 
            id: 'eem1',
            title: 'EEM 1: Mekanik & Uçuş Kontrol', 
            icon: '🛠️',
            tasks: ['A', 'B', 'H1', 'H2'],
            description: 'İHA\'ların fiziksel montajı, uçuş kontrol kartlarının ayarlanması ve saha testlerinin liderliğinden sorumludur.'
        },
        { 
            id: 'eem2',
            title: 'EEM 2: Haberleşme & Sensörler', 
            icon: '⚡',
            tasks: ['D', 'G', 'H1', 'H2'],
            description: 'Haberleşme donanımları, kamera ve sensörlerin entegrasyonu ile saha testleri sırasında veri takibinden sorumludur.'
        }
    ],
    details: [
        { 
            id: 'A', 
            content: `
                <h4 class="font-semibold text-sky-600 mt-2 mb-1">Amaç:</h4> İki adet sabit kanatlı İHA platformunun fiziksel olarak uçuşa hazır hale getirilmesi ve aviyonik bileşenlerin montajının tamamlanması.
                <h4 class="font-semibold text-sky-600 mt-2 mb-1">Temel Çıktılar:</h4> 
                <ul class="list-disc list-inside ml-4 text-sm">
                    <li>İHA Gövdelerinin Mekanik Montaj Raporu.</li>
                    <li>Motor, ESC (SkyWalker 80A), Servo motor (MG90S) ve güç sistemlerinin (14.8V Lipo Batarya, UBEC) güvenli kablolama diyagramı ve test protokolü.</li>
                </ul>
                <h4 class="font-semibold text-sky-600 mt-2 mb-1">Başarı Kriteri:</h4> Tüm donanım bileşenlerinin (Motor, ESC, Servo) RC Kumanda ile manuel olarak kontrol edilebilir ve test voltajlarında sorunsuz çalışabilir durumda olması.
            `
        },
        { 
            id: 'E', 
            content: `
                <h4 class="font-semibold text-sky-600 mt-2 mb-1">Amaç:</h4> Projenin algoritmik geliştirme ve ön test aşamaları için gerçekçi bir sanal ortamın kurulması.
                <h4 class="font-semibold text-sky-600 mt-2 mb-1">Temel Çıktılar:</h4> 
                <ul class="list-disc list-inside ml-4 text-sm">
                    <li>Görev bilgisayarlarında (RPi/Jetson) ROS2 (Robot Operating System 2) ve Gazebo simülasyon yazılımlarının stabil kurulumu.</li>
                    <li>Sabit kanatlı İHA (Keşif/Kamikaze) modellerinin Gazebo ortamına entegrasyonu. Sanal gimbal, GPS ve kamera arayüzlerinin ROS2 topic'ler üzerinden çalışır hale getirilmesi.</li>
                </ul>
                <h4 class="font-semibold text-sky-600 mt-2 mb-1">Başarı Kriteri:</h4> İki İHA modelinin de Gazebo'da otonom uçuşa uygun bir şekilde simüle edilebilir ve ROS2 üzerinden kontrol edilebilir olması.
            `
        },
        { 
            id: 'B', 
            content: `
                <h4 class="font-semibold text-sky-600 mt-2 mb-1">Amaç:</h4> Pixhawk otopilotların uçuşa hazırlanması ve temel stabilite ayarlarının yapılması.
                <h4 class="font-semibold text-sky-600 mt-2 mb-1">Temel Çıktılar:</h4> 
                <ul class="list-disc list-inside ml-4 text-sm">
                    <li>PX4 uçuş kontrol yazılımının yüklenmesi ve tüm sensör (IMU, GPS, Pusula) kalibrasyonlarının tamamlanması.</li>
                    <li>Uçuş modlarının (Stabilize, Otonom, Görev) ayarlanması ve RC Kumanda ile tam uyumluluk testi.</li>
                </ul>
                <h4 class="font-semibold text-sky-600 mt-2 mb-1">Başarı Kriteri:</h4> İHA'ların yer testlerinde (motor, kontrol yüzeyleri) hatasız tepki vermesi ve Pixhawk'ın uçuş öncesi tüm kontrol listelerini (pre-flight checks) geçmesi.
            `
        },
        { 
            id: 'D', 
            content: `
                <h4 class="font-semibold text-sky-600 mt-2 mb-1">Amaç:</h4> Merkeziyetsiz İHA-İHA ve İHA-Bulut iletişim altyapısının donanımsal ve yazılımsal olarak kurulması.
                <h4 class="font-semibold text-sky-600 mt-2 mb-1">Temel Çıktılar:</h4> 
                <ul class="list-disc list-inside ml-4 text-sm">
                    <li>LoRa modüllerinin (SX1262 HAT) ve GSM modülünün (SIM808) görev bilgisayarına entegrasyonu ve sürücü kurulumu.</li>
                    <li>İHA-İHA arası koordinat veri paketlerini işleyen ve minimum 50ms gecikmeyi hedefleyen LoRa iletişim protokolü yazılımı.</li>
                    <li>Keşif İHA'sından telemetri verilerini bulut platformuna aktaran GSM/MQTT yazılımının geliştirilmesi.</li>
                </ul>
                <h4 class="font-semibold text-sky-600 mt-2 mb-1">Başarı Kriteri:</h4> LoRa üzerinden iki İHA arasında %95 üzeri veri bütünlüğü ile 1 km menzilde veri transferinin sağlanması.
            `
        },
        { 
            id: 'C', 
            content: `
                <h4 class="font-semibold text-sky-600 mt-2 mb-1">Amaç:</h4> Yüksek doğrulukta hedef tespiti ve konumlandırma için hibrit yapay zekâ algoritmalarının geliştirilmesi.
                <h4 class="font-semibold text-sky-600 mt-2 mb-1">Temel Çıktılar:</h4> 
                <ul class="list-disc list-inside ml-4 text-sm">
                    <li>YOLO tabanlı nesne tespit modelinin prototip QR kod tespiti için hazırlanması ve optimizasyonu.</li>
                    <li>Görüntüdeki potansiyel hedef bölgelerini hızlıca daraltan Adaptive Thresholding ve kenar algılama ön işlem kodunun yazılması.</li>
                    <li>Tespit edilen hedefin kamera parametreleri ve İHA konumu kullanılarak GPS koordinatını ($\mathbf{\pm2}$ metre hassasiyetle) hesaplayan Fotogrametrik Konumlandırma Modülü.</li>
                </ul>
                <h4 class="font-semibold text-sky-600 mt-2 mb-1">Başarı Kriteri:</h4> Simülasyon ortamında QR kod hedeflerini $\mathbf{\%90}$ üzeri doğrulukla ve $\mathbf{\pm2}$ metre konum hassasiyetiyle tespit edebilen entegre yazılım modülü.
            `
        },
        { 
            id: 'F', 
            content: `
                <h4 class="font-semibold text-sky-600 mt-2 mb-1">Amaç:</h4> Kamikaze İHA'sının aldığı koordinatlara göre otonom ve kararlı bir saldırı rotası planlayıp icra etmesi.
                <h4 class="font-semibold text-sky-600 mt-2 mb-1">Temel Çıktılar:</h4> 
                <ul class="list-disc list-inside ml-4 text-sm">
                    <li>Hedef koordinatlarına göre en uygun dalış açısını ve hızını belirleyen Rota Planlama Algoritması.</li>
                    <li>PX4'ün güdüm komutları kullanılarak hedefe $\mathbf{\pm5}$ metre hassasiyetle yaklaşmayı sağlayan Otonom Güdüm ve Kontrol Modülü.</li>
                    <li>Görev sonrası İHA'nın güvenli irtifaya tırmanmasını ve geri dönmesini sağlayan Kurtarma Prosedürü yazılımı.</li>
                </ul>
                <h4 class="font-semibold text-sky-600 mt-2 mb-1">Başarı Kriteri:</h4> Simülasyon ortamında otonom dalışın hedeften sapma miktarının sürekli olarak $\mathbf{<5}$ metre aralığında kalması.
            `
        },
        { 
            id: 'G', 
            content: `
                <h4 class="font-semibold text-sky-600 mt-2 mb-1">Amaç:</h4> Tüm yazılımların (C, D, F) sanal ortamda bir araya getirilerek uçtan uca senaryonun test edilmesi ve optimizasyonu.
                <h4 class="font-semibold text-sky-600 mt-2 mb-1">Temel Çıktılar:</h4> 
                <ul class="list-disc list-inside ml-4 text-sm">
                    <li>Keşif (Yapay Zekâ) ve Kamikaze (Güdüm) İHA'ları arasındaki veri akışını gösteren Simülasyon Veri Seti.</li>
                    <li>Simülasyon Hata Ayıklama Raporu ve Algoritma Optimizasyon Kayıtları.</li>
                    <li>Simülasyon Başarı Raporu.</li>
                </ul>
                <h4 class="font-semibold text-sky-600 mt-2 mb-1">Başarı Kriteri:</h4> Simülasyon ortamında Keşif-Tespit-Aktarım-Yaklaşım senaryosunun genel görev başarı oranının $\mathbf{\%90}$ ve üzerinde olması. Bu, saha testleri için ön şarttır.
            `
        },
        { 
            id: 'H1', 
            content: `
                <h4 class="font-semibold text-sky-600 mt-2 mb-1">Amaç:</h4> Sistemin ayrı ayrı temel işlevselliğini gerçek donanım ve uçuş koşullarında doğrulamak.
                <h4 class="font-semibold text-sky-600 mt-2 mb-1">Temel Çıktılar:</h4> 
                <ul class="list-disc list-inside ml-4 text-sm">
                    <li>Keşif İHA'sının otonom kalkış, belirli bir rotada stabil uçuş ve iniş testleri.</li>
                    <li>LoRa/GSM modülleri üzerinden yer istasyonuna kesintisiz telemetri veri aktarım testleri.</li>
                    <li>Yerel alan kamerası (QR kod) tespit ve koordinat hesaplama hızının statik yer testleri.</li>
                </ul>
                <h4 class="font-semibold text-sky-600 mt-2 mb-1">Başarı Kriteri:</h4> Her iki İHA'nın da tüm otonom uçuş modlarında stabil ve güvenli şekilde uçuş yapabildiğinin kanıtlanması.
            `
        },
        { 
            id: 'H2', 
            content: `
                <h4 class="font-semibold text-sky-600 mt-2 mb-1">Amaç:</h4> Tüm sistemin gerçek uçuş koşullarında entegre olarak tam görev senaryosunu gerçekleştirmesi.
                <h4 class="font-semibold text-sky-600 mt-2 mb-1">Temel Çıktılar:</h4> 
                <ul class="list-disc list-inside ml-4 text-sm">
                    <li>Gerçek zamanlı hedef tespiti ve aktarımı gecikme (Latency) metrikleri.</li>
                    <li>Kamikaze İHA'sının hedefe yaklaşma hassasiyeti (metre bazında sapma) kayıtları.</li>
                    <li>Uçuş sırasında elde edilen tüm telemetri ve görev verilerinin veri tabanı kaydı.</li>
                </ul>
                <h4 class="font-semibold text-sky-600 mt-2 mb-1">Başarı Kriteri:</h4> Tam görev senaryosunun tekrarlanabilir şekilde $\mathbf{\%80}$ ve üzeri genel görev başarı oranıyla tamamlanması.
            `
        },
        { 
            id: 'I', 
            content: `
                <h4 class="font-semibold text-sky-600 mt-2 mb-1">Amaç:</h4> Elde edilen tüm verilerin analiz edilmesi ve projenin bilimsel çıktılarının oluşturulması.
                <h4 class="font-semibold text-sky-600 mt-2 mb-1">Temel Çıktılar:</h4> 
                <ul class="list-disc list-inside ml-4 text-sm">
                    <li>Simülasyon ve Saha Sonuçlarının Karşılaştırmalı Performans Analiz Raporu.</li>
                    <li>Proje Sonuç Raporu ve Nihai Proje Sunumu.</li>
                    <li>En az 1 adet ulusal/uluslararası konferans bildirisi veya makale taslağı.</li>
                </ul>
                <h4 class="font-semibold text-sky-600 mt-2 mb-1">Başarı Kriteri:</h4> Tüm hipotezlerin toplanan nicel verilerle desteklenerek veya çürütülerek bilimsel bir dille belgelenmesi.
            `
        }
    ]
};

document.addEventListener('DOMContentLoaded', () => {
    const ganttChart = document.getElementById('gantt-chart');
    const ganttHeaderContainer = document.querySelector('.gantt-grid');
    const rolesContainer = document.querySelector('#gorev-dagilimi .grid');
    const accordionContainer = document.getElementById('accordion-container');
    
    // Generate Gantt Headers (1 to 52)
    for (let i = 1; i <= 52; i++) {
        const headerCell = document.createElement('div');
        // Haftaları daha anlaşılır göstermek için her 4 haftada bir numara yazdır
        headerCell.textContent = (i % 4 === 0) ? `${i}.H` : '';
        headerCell.className = `text-xs text-center ${(i % 4 === 0) ? 'font-bold' : ''}`;
        ganttHeaderContainer.appendChild(headerCell);
    }

    // Generate Gantt Chart & Accordion
    projectData.tasks.forEach(task => {
        // Gantt Row
        const label = document.createElement('div');
        label.className = 'gantt-label bg-slate-50 rounded-l-lg font-medium text-sm text-slate-700';
        label.textContent = `İP ${task.id}`;

        const grid = document.createElement('div');
        grid.className = 'gantt-grid';

        const bar = document.createElement('div');
        bar.className = `gantt-bar bg-${task.discipline} text-white text-xs flex items-center justify-center p-1 rounded-lg h-[40px] shadow`;
        bar.style.setProperty('--start', task.start);
        bar.style.setProperty('--duration', task.duration);
        bar.textContent = task.name;
        bar.dataset.taskId = task.id;
        bar.dataset.discipline = task.discipline;

        grid.appendChild(bar);
        ganttChart.appendChild(label);
        ganttChart.appendChild(grid);
        
        // Accordion Item
        const detail = projectData.details.find(d => d.id === task.id);
        const accordionItem = document.createElement('div');
        accordionItem.id = `task-card-${task.id}`;
        accordionItem.className = `task-card bg-white rounded-2xl shadow-lg border-l-8 border-${task.discipline} transition-all duration-300 overflow-hidden`;

        accordionItem.innerHTML = `
            <div class="accordion-header p-5 cursor-pointer flex justify-between items-center">
                <div>
                    <h3 class="font-bold text-lg">${task.id}: ${task.name}</h3>
                    <p class="text-sm text-slate-500">Sorumlu: ${task.sorumlu} | Süre: ${task.duration} Hafta</p>
                </div>
                <span class="text-2xl font-light text-slate-500 transform transition-transform duration-300">+</span>
            </div>
            <div class="accordion-content">
                <div class="p-5 pt-0 text-slate-600">
                    ${detail.content}
                </div>
            </div>
        `;
        accordionContainer.appendChild(accordionItem);
    });

    // Generate Role Cards
    projectData.roles.forEach(role => {
        const card = document.createElement('div');
        card.className = 'bg-white p-6 rounded-2xl shadow-lg flex flex-col';
        card.innerHTML = `
            <div class="flex items-center gap-4 mb-4">
                <span class="text-4xl">${role.icon}</span>
                <h3 class="text-xl font-bold">${role.title}</h3>
            </div>
            <p class="text-slate-600 mb-4 flex-grow">${role.description}</p>
            <button data-role-id="${role.id}" class="filter-btn mt-auto w-full bg-slate-200 text-slate-700 font-bold py-2 px-4 rounded-lg transition hover:bg-sky-200">
                Görevleri Vurgula
            </button>
        `;
        rolesContainer.appendChild(card);
    });
    
    // Accordion Logic
    accordionContainer.addEventListener('click', (e) => {
        const header = e.target.closest('.accordion-header');
        if (!header) return;

        const accordionItem = header.parentElement;
        const content = accordionItem.querySelector('.accordion-content');
        const icon = header.querySelector('span');
        const isOpen = content.style.maxHeight;
        
        // Close all others
        accordionContainer.querySelectorAll('.accordion-content').forEach(c => c.style.maxHeight = null);
        accordionContainer.querySelectorAll('.accordion-header span').forEach(i => i.classList.remove('rotate-45'));

        if (!isOpen) {
            content.style.maxHeight = content.scrollHeight + "px";
            icon.classList.add('rotate-45');
        }
    });

    // Gantt Bar Click Logic
    ganttChart.addEventListener('click', (e) => {
        const bar = e.target.closest('.gantt-bar');
        if(!bar) return;

        const taskId = bar.dataset.taskId;
        const targetCard = document.getElementById(`task-card-${taskId}`);

        if (targetCard) {
            // Remove highlight from all cards
            document.querySelectorAll('.task-card').forEach(card => card.classList.remove('highlight'));
            
            // Add highlight to target card
            targetCard.classList.add('highlight');
            targetCard.scrollIntoView({ behavior: 'smooth', block: 'center' });

            // Open the accordion
            const content = targetCard.querySelector('.accordion-content');
             if (!content.style.maxHeight) {
                targetCard.querySelector('.accordion-header').click();
             }
        }
    });
    
    // Filter Logic - Yenilenmiş ve İyileştirilmiş
    let activeFilter = null;
    document.querySelectorAll('.filter-btn').forEach(btn => {
        btn.addEventListener('click', () => {
            const roleId = btn.dataset.roleId;
            const roleTasks = projectData.roles.find(r => r.id === roleId).tasks;
            const ganttBars = document.querySelectorAll('.gantt-bar');
            
            if (activeFilter === roleId) {
                // Filtreyi Kaldır
                ganttBars.forEach(bar => bar.classList.remove('gantt-bar-dimmed'));
                btn.classList.remove('filter-active');
                activeFilter = null;
            } else {
                // Diğer butonları deaktif et
                 document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('filter-active'));
                 
                // Bu filtreyi aktif et
                btn.classList.add('filter-active');
                activeFilter = roleId;

                ganttBars.forEach(bar => {
                    if (roleTasks.includes(bar.dataset.taskId)) {
                        bar.classList.remove('gantt-bar-dimmed'); // Vurgula
                    } else {
                        bar.classList.add('gantt-bar-dimmed'); // Solgunlaştır
                    }
                });
            }
        });
    });

    // Mobile Menu
    const mobileMenuButton = document.getElementById('mobile-menu-button');
    const mobileMenu = document.getElementById('mobile-menu');
    mobileMenuButton.addEventListener('click', () => {
        mobileMenu.classList.toggle('hidden');
    });

    // Close mobile menu on link click
    mobileMenu.addEventListener('click', (e) => {
        if (e.target.tagName === 'A') {
            mobileMenu.classList.add('hidden');
        }
    });
});
</script>

</body>
</html>
